<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Release Engineering 101: Building the Pipeline</title>

		<meta name="description" content="Slides for PLOW lecture in Montreal, October 2014">
		<meta name="author" content="Kim Moir">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/mozilla.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
				<section>
                                        <h1>Release</h1>
                                        <h1>Engineering 101</h2>
                                        <h2>Building the Pipeline</h2>
                                        <h4>PLOW Lecture, Ecole Polytechnique, October 2014</h4>
                                        <p>
					<small>Your instructor  <a href="http://relengofthenerds.blogspot.com">Kim Moir</a> / <a href="http://twitter.com/kmoir">@kmoir</a></small><br>
                                                <small>This presentation <a href="https://github.com/kmoir/Releng-tutorial">https://github.com/kmoir/Releng-tutorial</a></small>
                                        </p>
				</section>

                                <section>
                                        <h2>Outline - Lectures</h2>
                                        <ol>
                                                <li>Introductions</li>
                                                <li>Overview of Release Engineering</li>
                                                <li>Continuous Integration</li>
                                                <li>Build and Test pipelines</li>
                                                <li>Scaling your CI</li>
                                                <li>REST APIs</li>
                                                <li>Further reading</li>
                                        </ol>
                                </section>

                                <section>
                                        <h2>Outline - Labs</h2>
                                        <ol>
                                                <li>Using your AWS Instance and Git</li>
                                                <li>Setup a build on Jenkins</li>
                                                <li>Build from commit on Jenkins</li>
                                                <li>Invoke build and test scripts</li>
                                                <li>Add test results report</li>
                                                <li>Add Jenkins Plugins</li>
                                                <li>Create a pipeline by chaining jobs together</li>
                                                <li>Query Jenkins REST API</li>
                                                <li>Challenge Exercise</li>
                                        </ol>
                                </section>

				<section>
					<h2>About: me</h2>
			                <a class="image" href="images/mozilla_wordmark_300dpi.jpg" target="_blank">
                                                <img width="456" height="184" src="images/mozilla_wordmark_300dpi.jpg" alt="Mozilla">
                                        </a>	
                                        <br>
                                        <a class="image" href="images/Eclipse_Logo2014_New.jpg" target="_blank">
                                                <img src="images/Eclipse_Logo2014_New.jpg" alt="Eclipse">
                                        </a>


					<aside class="notes">
					     I currently work at Mozilla as a release engineer.  Prior to that, I worked at IBM as a release engineer in the Eclipse community.  So I've worked in open source communities for a long time.
                                             Most of the tools I'll show you today are open source too.
					</aside>
				</section>

                                <section>
					<h2>Mozilla Releng Worldwide</h2>
                                         <a class="image" href="images/remoties.png" target="_blank">
                                         <img width="580" height="361" src="images/remoties.png" alt="pipeline"></a>
                                <aside class="notes">
                                </aside>
                                </section>

                               <section>
                                        <h2>About: you</h2>
                                        <h2>?</h2>
                                </section>
				<aside class="notes">
				    How many of you have worked on a developent team before?
				    What open source tools do you use? Git? Eclipse? 
				    What languages to you write code in? Java? Ruby? Python? C++? JavaScript?
				    How many of you plan to work in indusry when you graduate?
				</aside>
				</section>
				
                                <section>
                                <section>
                                         <a class="image" href="images/6242766617_33374edd57_b.jpg" target="_blank">
                                                <img src="images/6242766617_33374edd57_b.jpg" alt="overview">
                                        </a>
					<br><small><a href="https://flic.kr/p/avDP2c">© Forest Wander</a>, Creative Commons by-nc-sa 2.0</br></small>
                                </section>


  				<section>
                                        <h2>What is release engineering?</h2>
                                         <blockquote cite="http://en.wikipedia.org/wiki/Release_engineering">
                                                &ldquo;
                                                a sub-discipline in software engineering concerned with the compilation, assembly, and delivery of source code into finished products or other software components.    --Wikipedia
                                                &rdquo;
                                        </blockquote> 
					<aside class="notes">
                                              At it's very essence we take source code, and turn it into products that you see on your phone, your desktop, at the bank machine, or on an airplane. We ensure that it
                                              compiles, is packaged, tested, signed, can be updated and deployed. You may be wondering how are jobs are different than traditional software developers.
					</aside>
                                </section>

                                <section>
                                        <h2>We build pipelines</h2>
                                         <a class="image" href="images/3958348428_483a6ddd8d_b.jpg" target="_blank">
                                             <img width="867" height="550" src="images/3958348428_483a6ddd8d_b.jpg" alt="pipeline">
                                        </a>  
                                        <br><small>An old rusty pipe on Deception Island in Antarctica. February 2009 <a href="https://flic.kr/p/72Mz5G">© Ville Miettinen</a>, Creative Commons by-nc-sa 2.0</br></small>
                                <aside class="notes">
                                </aside>
                                </section> 


                              <section>
                                        <h2>Role of the Release Engineer</h2>
                                        <ul>
                                        <li>Focus on writing code to build a pipeline versus a product</li>
                                        <ul>
                                        <li>scope depends on where you work</li>
                                        <li>scale depends on</li>
                                        <ul>
                                        <li>number of products</li>
                                        <li>number of platforms x supported versions</li>
                                        <li>number of tests</li>
                                        <li>number of commits</li>
                                        <li>release cadence</li>
                                        </ul>
                                        </ul>
                                        </ul>
                                <aside class="notes">
                                               Why can't it be just a regular developer doing this job?  Sometimes it is.  However, developers get very attached to their code and want to push new features despite them lacking stability. 
                                </aside>
                                </section>
 
                                <section>
                                        <h2>Committing code is only the first step</h2>
                                        <ul>
                                        <li>Build, test, package, sign and deploy</li>
                                        <li>mobile and desktop apps </li>
                                        <li>social media, banks, web sites for online retailers...</li>
                                        <li>on multiple platforms</li>
                                        <ul>
                                        <li>Desktop:Windows, Linux, Mac...</li>
                                        <li>Mobile: Android, IOS, FirefoxOS, Blackberry...</li>
                                        <li>Other: Trains, planes, cars, and drones...</li>
                                        </ul>
                                <aside class="notes">
                                     <p>Websites such as Google, Facebook, Twitter</p>
                                </aside>
                                </section>

                                <section>
                                     <h2>if software then releng</h2>
                                     <ul>
                                     <li>Akamai, Facebook, Google, LinkedIn, Twitter</li>
				     <li>Amazon, Mozilla, Etsy, Neflix, Tasktop</li>
				     <li>Oracle, IBM, HP, Microsoft, RedHat</li>
                                     <li>NASA, Boeing, Swiss Railways</li>
                                     <li>QNX, Hortonworks, Shopify, Puppet</li>
                                     <li>Open Source communities like</li>
                                     <ul>
                                     <li>Linux, Apache, Mozilla, Eclipse, Gentoo, Debian</li>
                                     </ul>
                                     </ul>
                                <aside class="notes">
                                     <p>Where do we work?</p>
                                </section>


                                <section>
                                        <p><a href="https://www.usenix.org/conference/ures14/technical-sessions/presentation/moving-mobile">Chuck Rossi, release engineering, Facebook</a>
                               <aside class="notes">
                                 <p>start 1:38 end 5:30</p>
                               </aside>
                               </section>

                                <section>
                                    <h2>Release Engineering Focus</h2>
                                    <ul>
                                    <li><b>Schedule</b></li> 
                                    <li><b>Quality</b></li> 
                                    <li><strike>Features</strike></li> 
				    <li>= shipping quality products on time</li> 
                                    <ul>
                                <aside class="notes">
                                     <p>Release engineers are not emotionally attached to the features in a product. Their focus is on building the pipeline that allows them to ship products on time. A software developer in a traditional role may have invested months working a a new feature in a product.  But if this new feature is not of sufficient quality to be included in the current release, it should not be included.  Release management or release engineering may make this decision, depending on where you work.
</p>
                                </section>

                                <section>
                                        <h2>Releng as a Force multiplier</h2>
                                        <ul>
                                        <li>Optimize the pipeline</li>
                                        <li>Make the development team as a whole more effective</li>
                                        <ul>
                                        <li>Reduce the end to end build time by 50%?</li>
                                        <li>Scale testing in the cloud to reduce wait times?</li>
                                        <li>Ship a release in a day?</li>
					<li><a href="codeascraft.com/2014/09/30/building-a-better-build-our-transition-from-ant-to-sbt">Implement a new build system?</a></li>
                                        </ul>
                                        </ul>
                                <aside class="notes">
                                      <p>John O'Duinn, gave a talk a couple of years ago about called release engineering as a force multiplier.  It describes in 
                                      detail how the changes in Mozilla release engineering make the development team as a whole more effective.
                                   </p> 
                                </aside>
                                </section>

                                <section>
                                         <a class="image" href="images/stubbornella.png" target="_blank">
                                         <img width="625" height="282" src="images/stubbornella.png" alt="pipeline"></a>
                                <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                     <h2>Scale</h2>
                                     <ul>
                                     <li>At Mozilla we run about 4k build jobs and 10k test jobs a day</li>
                                     <li>80% of builds and 50% of tests run on cloud instances</li>
                                     <li>Build farm consists of 6000 devices</li>
                                     <li>Scaling isues are fun!</li>
                                     </ul>
                                <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                        <a class="image" href="images/panda.jpg" target="_blank">
                                        <img width="670" height="933" src="images/panda.jpg" alt="pandas"></a>
                                <aside class="notes">
                                </aside>
                                </section>


                                <section>
                                     <h2>Tools</h2>
                                     <a class="image" href="images/python.png" target="_blank">
	                             <img width="262" height="85" src="images/python.png" alt="puppet"></a>
                                     <a class="image" href="images/buildbot.jpg" target="_blank">
	                             <img width="259" height="83" src="images/buildbot.jpg" alt="puppet"></a>
                                     <a class="image" href="images/puppet.png" target="_blank">
	                             <img width="185" height="82" src="images/puppet.png" alt="puppet"></a>
                                     <a class="image" href="images/jenkins.png" target="_blank">
	                             <img width="254" height="121" src="images/jenkins.png" alt="puppet"></a>
                                     <a class="image" href="images/git.jpg" target="_blank">
	                             <img width="134" height="62" src="images/git.jpg" alt="puppet"></a>
                                     <a class="image" href="images/AWSb.jpg" target="_blank">
	                             <img width="186" height="74" src="images/AWS.jpg" alt="puppet"></a>
                                     <a class="image" href="images/mecurial.jpg" target="_blank">
	                             <img width="158" height="44" src="images/mercurial.jpg" alt="puppet"></a>
                                     <a class="image" href="images/docker.png" target="_blank">
	                             <img width="177" height="56" src="images/docker.png" alt="puppet"></a>
                                <aside class="notes">
                                </aside>
                                </section> 


                                <section>
                                         <a class="image" href="images/relengsimple.png" target="_blank">
                                             <img width="867" height="550" src="images/relengsimple.png" alt="relengsimple">
                                        </a>
                                        <br><small><a href="http://oduinn.com/blog/2013/06/07/release-engineering-as-a-force-multiplier-relengcon-2013/">John O'Duinn's Mozilla release pipeline</a></br></small>
                                        <br><small><a href="https://treeherder.mozilla.org/ui/#/jobs?repo=mozilla-central">Tree Herder Status</a></br></small>
                                <aside class="notes">
                                <aside class="notes">
				<p>
				This is a picture of how the different parts of our build farm work together.  Developers land change on code repositories such as hg.mozilla.org.

				As I mentioned before, we use an open source continuous integration engine called Buildbot.   We have over 50 buildbot masters.  Masters are segregated by function to runn tests, builds, scheduling, and try.  Test and build masters are further divided by function so we can limit the type of jobs they run and the types of slaves they serve.  For instance, a master may have Windows build slaves allocated to it.  Or Android test slaves.  This makes the masters more efficient because you don’t need to have every type of job loaded and consuming memory.  It also makes maintenance more efficient in that you can bring down for example, Android test masters for maintenance without having to touch other platforms.

				Buildbot polls the hg push log for each of the code repositories. (Hgpoller)

				When the poller detects a change, the information about the change is written into the scheduler database.  The buildbot scheduler masters are responsible for taking this request in the database and creating a new build request.  The build request then will appear as pending in the web page in the previous slide.

				The jobs may be on existing hardware in our data centre, or new VMs may start or be created in the cloud to run these pending jobs.

				When the job finishes, logs and artifacts are uploaded to FTP. The results appear on tbpl. Performance results are stored in the graphs database.

				——
				References
				http://people.mozilla.org/~catlee/relengdocs/flows.html#firefox-builds-from-checkin-to-tbpl
				http://oduinn.com/blog/2013/06/07/release-engineering-as-a-force-multiplier-relengcon-2013/
				</p>
                                </aside>
                                </section>

                                <section>
                                         <a class="image" href="images/relengflows.png" target="_blank">
                                             <img width="867" height="550" src="images/relengflows.png" alt="relengflows">
                                        </a> 
                                        <br><small><a href="https://wiki.mozilla.org/images/5/5b/Releng_flow_onepage.pdf">Selena Deckelman's diagram of Mozilla Release Engineering flows</a></br></small>
                                <aside class="notes">
				    This is a more complicated picture of how the the release engineering pipeline at Mozilla works.  As you can see, it's rereally a large distributed system. Implementing changes on it is quite complex.
                                </aside>
                                </section>

                              <section>
                                        <h2>Other related disciplines:</h2>
                                        <h2>Configuration Management</h2>
                                        <a class="image" href="images/puppet.png" target="_blank">
                                     <img width="185" height="82" src="images/puppet.png" alt="puppet"></a>
                                        <a class="image" href="images/chef.png" target="_blank">
                                     <img width="92" height="107" src="images/chef.png" alt="chef"></a>
                               <aside class="notes">
                                      <p>Puppet, Chef, Ansible, Docker.  We have several thousand devices in our buildfarm at Mozilla. We need to management them at Scale.  For many of our devices we use Puppet to configure them automatically i.e. install a new package, change a file, configure a new platform</p>
                               </aside> 
                               </section>

                               <section>
                                      <h2>Build, Test and Release Automation</h2>
                                     <a class="image" href="images/5982549938_ebee95dff1_z.jpg" target="_blank">
                                     <img width="640" height="427" src="images/5982549938_ebee95dff1_z.jpg" alt="gears"></a>
			     <br><small><a href="https://www.flickr.com/photos/freefoto/5982549938/sizes/z/">© Ian Britton</a>, Creative Commons by-nc-sa 2.0</br></small>
                               <aside class="notes">
                                      <p>Automate all the things</p>
                               </aside>
                               </section>


                               <section>
                                        <h2>Continuous Integration/Deployment</h2>
                                        <ul>
                                        <li>Evaluating and writing tools</li>
                                        <li>Optimizing the pipeline for shorter end to end times</li>
                                        <li>Removing bottlenecks then finding new ones </li>
                                        <li>Reducing costs and scaling capacity</li>
                                        </ul>
                               <aside class="notes">
                               </aside>
                               </section>


                               <section>
                                        <h2>Release Management</h2>
                                     <a class="image" href="images/eclipse.jpg" target="_blank">
                                     <img width="525" height="394" src="images/eclipse.jpg" alt="mozillareposcale"></a>
                               <aside class="notes">
                                      <p>Coordinating with a development team to determine what is shipped in release</p>
                               </aside>
                               </section>

                               <section>
                                        <h2>Repository Management</h2>
                                        <a class="image" href="images/reposcale.png" target="_blank">
                                     <img width="628" height="324" src="images/reposcale.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                               </aside>
                               </section>

                               <section>
                                        <h2>Branching Strategies</h2>
                                        <a class="image" href="images/trains.jpg" target="_blank">
                                     <img width="698" height="384" src="images/trains.jpg" alt="trains"></a>
                               <aside class="notes">
                               </aside>
                               </section>


                               <section>
                                        <h2>Package and Dependency Management</h2>
                                        <a class="image" href="images/dependencies.png" target="_blank">
                                     <img width="579" height="158" src="images/dependencies.png" alt="mozillareposcale"></a>
			     <br><small><a href="http://imgs.xkcd.com/comics/dependencies.png">© xkcd - Dependencies - Randall Munroe</a></br></small>
                               <aside class="notes">
                                   artifactory, maven repos, p2 repos, pypi, custom rpms, different languages or operating systems have different package management systems and thus different ways of managing dependencies i.e. pip, apt-get, java jars. And there are also different types of deployment artifacts
                               </aside>
                               </section>

                               <section>
                                   <h2>Going from 3 week to Daily releases</h2 >
                                    <p><a href="https://www.usenix.org/conference/ures14/technical-sessions/presentation/going-3-week-daily-releases-netflix">Daniel Zapata, software engineer, Netflix  </a>
                               <aside class="notes">
                                     <p>0:44-3:15</p>
                               </aside>
                               </section> 


                              <section>
                                        <h2>Testing and Quality Assurance</h2>
                                        <ul>
                                        <li>Porting tests to new platforms</li>
                                        <li>Writing Test harnesses</li>
					<ul>
                                        <li>Unit tests</li>
                                        <li>Performance tests</li>
                                        <li>Regression testing</li>
					<ul>
                                        </ul>
                               <aside class="notes">
                               </aside>
                               </section>

                               <section>
                                   <h2>Building a physical device lab</h2 >
                                    <p><a href="http://youtu.be/RTez9SEi2xI?t=4m45s">Lara Swanson, engineering manager, Etsy</a>
                               </section> 
                               <aside class="notes">
			          <p>4:45-7:49</p>
                               </aside>
                               </section> 

                               <section>
                                    <h2>Our project</h2>
                                     <p></li>
                                     <ul>
                                     <li>Setup a simple build pipeline using Jenkins on AWS</li>
                                     <li>Install additional Jenkins plugins</li>
                                     <li>Query Jenkins build status using REST API</li>
                                     </ul>
                                </section>

                                <section>
                                <section>
                                    <h2>Lab 1: Using your AWS instance</h2>
                                     <p>Goal: Login to your AWS instance via ssh.  Query the packages that are available on it </li>
                                     <ul>
                                     <li>AWS = Amazon web services</li>
                                     <li>Shared cloud resources</li>
                                     <li><a href="http://aws.amazon.com/ec2/instance-types/">Different instance types</a> - different resources - memory, disk, CPU</li>
                                     <li>We are using a m3.large instance type running Ubuntu 14.04</li>
                                     </ul>
                               <aside class="notes">
			            mention other cloud services Azure, IBM etc 
                               </aside>
                                </section>  

                                 <section>
                                    <h2>Lab 1: Login to your instance</h2>
                                     <ul>
					     <li>ssh -l <i>username hostname</i></li>
				     <li><i>if needed, you can sudo - root</i></li>
                                     <li>look at packages installed</li>
                                     </ul>
				     <pre>
dpkg -l | more 
dpkg -l | grep jenkins
				     </pre>

                                </section>

                                <section>
                                    <h2>Lab 1: Git</h2>
				     <ul>
                                     <li>Git is a distributed version control system</li>
                                     <li>Git Design Goals: fast, secure, distributed</li>
                                     <li>Each commit has a corresponding hash key</li>
                                     <li>Everyone has a local copy of the history</li>
				     </ul>
                                </section>  

                                 <section>
                                    <h2>Lab 1: Git - quick command guide</h2>
                                     <pre>
git clone repo_name           #clone a repository locally
cd repo_name        
vi my_file          
git add my_file               #add my_file to git tracking
git status                    #see the status of the git repository 
git commit -a -m "a comment"   #commit the change to the local repository
git push                      #push the change to the remote repository
git branch                    #show current branch
git checkout -b branch2       #create new local branch
				     </pre>
                                <aside class="notes">
                                      You can use Git within an IDE if you want, but these are the command line arguments 
                                </aside>
                                </section>


                              <section>
                                    <h2>Lab 1: Git exercise</h2>
                                     <pre>
cd /home/ubuntu
git clone https://github.com/salimfadhley/jenkinsapi     
cd jenkinsapi
git branch 
git tag
git log
git status 
git config --global user.name "Your Name"
git config --global user.email you@example.com
                                     </pre>
                                <aside class="notes">
                                     Clone the jenkinsapi project locally to your AWS machine
                                     Look at the status of the repo (no pending changes) 
                                     git log - look at recent changes
                                </aside>
                                </section>
				</section>

			       <section>
			       <section>
                                    <h2>Lab 2: Continuous Integration</h2>
                                    <ul>
                                    <li>Everything in version control - build, test and deployment  scripts</li>
                                    <li>Automate all the things: Build, test, deployment, update process</li>
                                    <li>Build on commit</li>
                                    <li>Fix problems as they arise</li>
				    <li><a href="http://www.infoq.com/research/ci-servers">Popular CI servers</a></li>
                                    </ul>
                                    <aside class="notes">
                                    <p>some are opensource, some are commercial. i.e. Jenkins, Hudson, Travis from GitHub, Buildbot, Bamboo from Atlassian</p>
                                    </aside>
			       </section>



                               <section>
                                    <h2>Lab 2: Jenkins</h2>
                                    <ul>
				    <li><a href="http://jenkins-ci.org">Jenkins</a> in a continuous integration engine</li>
                                    <li>Written in Java</li>
                                    <li>Open source</li>
                                    <li>Plugin architecture that allows you to add functionality in a modular fashion</li>
				    <li>Many community <a href="https://wiki.jenkins-ci.org/display/JENKINS/Plugins">plugins</a> available</li> </li>
                                    </ul>
                               <aside class="notes">
                                   https://wiki.jenkins-ci.org/display/JENKINS/Plugins
				   Examples in the wild: Netflix, as well as the Apache project (https://builds.apache.org)
				   (Mozilla uses Buildbot which scales better for our volume)
                                </aside>
                                </section>

                              <section>
                                    <h2>Lab 2: Jenkins</h2>
				    <ul>
                                    <li>Jenkins welcome page</li>
				    <li>at your machine's  <i>http://fqdn:8080</i></li>
				    </ul>
                                        <a class="image" href="images/jenkinswelcome.png" target="_blank">
                                     <img width="1384" height="408" src="images/jenkinswelcome.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                    <h2>Lab 2: Jenkins login</h2>
                                    <ul>
                                    <li>Select <b>login</b> in on left hand side</li>
                                    <li>Username and password are on whiteboard</li>
                                    <li>Select <b>Remember me on this computer</b></li>
                                    </ul>
                                        <a class="image" href="images/jenkinswelcome.png" target="_blank">
                                     <img width="1002" height="483" src="images/jenkinswelcome.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                                </aside>
                                </section>



                               <section>
                                    <h2>Lab 2: Jenkins: Create a job</h2>
                                    <ul>
                                    <li>Select <b>New Item</b> on left side of screen</li>
                                    <li>In <b>Item name</b> give your job a name</li>
                                    <li>Select <b>Freestyle project</b> and select <b>OK</b></li>
                                    </ul>
                                        <a class="image" href="images/jenkinsjob.png" target="_blank">
                                     <img width="1419" height="537" src="images/jenkinsjob.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                               <section>
                                    <h2>Lab 2: Jenkins: Clone from Git</h2>
                                    <ul>
                                    <li>Under <b>Source Code Management</b> select Git</li>
				    <li>Under <b>Repository URL	</b> enter the path to your local git repository i.e. /home/ubuntu/jenkinsapi and select <b>Save</b></li>
                                    <li>Then select  <b>Build Now</b> on the left hand side of the screen</li>
                                    </ul>
                                        <a class="image" href="images/jenkinsgit.png" target="_blank">
                                     <img width="722" height="447" src="images/jenkinsgit.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                               <section>
                                    <h2>Lab 2: Jenkins: Build Results</h2>
                                    <ul>
                                    <li>When the build finishes, look <b>Console Ouput</b></li>
                                    </ul>
                                        <a class="image" href="images/jenkinsconsole.png" target="_blank">
                                     <img width="1446" height="549" src="images/jenkinsconsole.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                                </aside>
                                </section> 
                                </section> 


				<section>
                                <section>
                                    <h2>Lab 3: Jenkins: Build on Commit</h2>
                                    <ul>
                                    <li>Select <b>Back to Project</b></li>
                                    <li>Select <b>Configure</b></li>
                                    <li>Select <b>Poll SCM</b></li>
                                    <li>Under <b>Schedule </b> enter <b>H/2 * * * *</b> to poll git every two minutes</li>
                                    <li>Select <b>Save</b></li>
                                    </ul>
                                        <a class="image" href="images/jenkinsgit.png" target="_blank">
                                     <img width="722" height="447" src="images/jenkinsgit.png" alt="mozillareposcale"></a>
                               <aside class="notes">
                                </aside>
                                </section>
				 
                                 <section>
                                    <h2>Lab 3: Jenkins: Commit a file</h2>
                                    <pre>
ubuntu@ip-172-31-31-167:~/jenkinsapi$ cat TODO 
TODO:

* Add a testsuite (preferably nose or py.test) which doesn't rely on a local jenkins setup (or instantiates one during test)
* Clean up the fingerprint code
* Clean up the resultset and results code
* Make all objects inherit off jenkins_base where that makes sense
* Add ability to add/modify/delete jobs
* Add ability to query jenkins for plugin data

ubuntu@ip-172-31-31-167:~/jenkinsapi$ vi TODO
ubuntu@ip-172-31-31-167:~/jenkinsapi$ git commit -a -m "updated TODO"
[master d55e7e2] updated TODO

                                    </pre>
                               <aside class="notes">
                                  <p>You can update any file, it doesn't matter</p>
                                </aside>
                                </section>

                                <section>
                                    <h2>Lab 3: Jenkins: Look at job output</h2>
                                    <ul>
                                    <li>Another job should start within 2 minutes</li>
                                    <li>But only if there is a new commit</li>
                                    </ul>
                                     <a class="image" href="images/jenkinscommit.png" target="_blank">
                                     <img width="1448" height="499" src="images/jenkinscommit.png" alt="jenkinscommit"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                    <h2>Build on Commit vs build on Trunk</h2>
                                    <p>Why is it important?</b>
                               <aside class="notes">
                                    Many small projects just build from trunk (master branch) or other designated branch.
                                    However, this does not often scale when you have a large code base + a large team of developers.
                                    It's difficult to determine who caused the breaking failure if you have a large number of changes and you only run a build once a day.
                                    If you build on commit, you can quickly see what caused the breaking failure and back it out before other changes cascade on top of it.
                                    If you don't have the infrastructure money to build on commit, you can build and run tests locally i.e. in your IDE before committing code to the canonical repo
                                    However, this doesn't address integration 100% - having your code integrate with all the other code in the repo
                                </aside>
                                </section>


                               <section>
                                    <h2>Bisect, fix bustage or backout</h2>
				    <ul>
				    <li>Use tools such as <a=href="http://git-scm.com/book/en/Git-Tools-Debugging-with-Git">git bisect</a> to identify the offending commit</li>
				    <li>Backout the change set or fix the code</li>
				    </ul>
                               <aside class="notes">
                                </aside>
                                </section>
				</section>
 
                                <section>
                                <section>
                                    <h2>Lab 4: Add more build steps</h2>
                                    <ul>
                                    <li>Select your build</li>
				    <li>Go to <b>Configure</b></li>
                                    <li>Under the <b>Build</b> heading, select <b>Add build step</b></li>
                                    <li>Select <b>Execute shell</b></li>
                                    </ul>
                                    <a class="image" href="images/jenkinsscript.png" target="_blank">
	                            <img width="1439" height="591" src="images/jenkinsscript.png" alt="jenkinscommit"></a>
                               <aside class="notes">
			            <p>The people who maintain the Python Jenkins API are really nice to includes a Jenkins script we can run to replicate their build</p>
			            <p>It uses virtualenv to create a Python virtual environment to run the tests</p>
			            <p>This is a good practive because it keeps the test environment separate from the machine environment</p>
                                </aside>
                                </section>


                                <section>
                                    <h2>Lab 4: Add more build steps</h2>
                                    <ul>
					    <li>Text to put in the <b>Command</b> box</li>
				    </ul>
                                    <pre><code data-trim contenteditable>
chmod 755 $WORKSPACE/jenkins_build.sh
$WORKSPACE/jenkins_build.sh
                                    </code>
                                    </pre>
                                    <ul>
					    <li>Select <b>Save</b></li>
					    <li>Select <b>Build now</b></li>
					    <li>The build will take about 7 minutes</li>
					    <li>What can you tell from the build output?</li>
				    </ul>
                               <aside class="notes">
                                </aside>
                                </section>

                                 <section>
                                    <h2>Lab 4: Add Test Results report</h2>
                                    <ul>
                                    <li>Go back to your project</li>
				    <li>Select <b>Configure</b></li>
                                    <li>Under <b>Add post-build action</b></li>
                                    <li>Select <b>Publish JUnit test result report</b></li>
                                    <li>Enter <b>nosetests.xml</b></li>
				    <li>Enter <b>Save</b> and rerun your build</li>
                                    </ul>
                                    <a class="image" href="images/jenkinsjunit.png" target="_blank">
                                    <img width="1126" height="441" src="images/jenkinsjunit.png" alt="jenkinsjunit"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                                 <section>
                                    <h2>Lab 4: Test Results report</h2>
                                    <ul>
                                    <li>Go back to your project</li>
                                    <li>On left hand side, select test result</li>
                                    </ul>
                                    <a class="image" href="images/jenkinstestsresults.png" target="_blank">
                                    <img width="1010" height="539" src="images/jenkinstestresults.png" alt="jenkinstestresults"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                    <h2>Lab 4: Break things</h2>
                                    <ul>
                                    <li>Go change some code in the repository to break the build</li>
                                    <li>i.e. comment out some files in the code</li>
                                    </ul>
                               <aside class="notes">
                                </aside>
                                </section>

                               <section>
                                    <h2>Lab 4: Bonus labs</h2>
                                    <ul>
                                    <li>Write a script to generate many commits to your git repository</li>
                                    <li>Add additonal excecutors to the Jenkins install</li>
                                    <li>Look at the number of queued jobs</li>
                                    </ul>
                               <aside class="notes">
                                </aside>
                                </section>
 
                                </section>

                                <section>
                                <section>
                                    <h2>Lab 5: Add a plugin</h2>
                                    <ul>
                                            <li>On the left hand side select <b>Back to Dashboard</b></li>
                                            <li>On the left hand side select <b>Manage Jenkins</b></li>
                                            <li>Select <b>Manage Plugins</b></li>
                                            <li>Select the <b>Available</b> tab</li>
                                            <li>You'll see a list of available plugins<b></b></li>
                                            <li>Check the <b>Build Pipeline</b> plugin</li>
                                            <li>Select <b>Install</b> plugin</li>
                                            <li>Select <b>Download now and install after restart</b> plugin</li>
                                            <li>Select <b>Restart Jenkins when installation is complete and no jobs are running</b></li>
                                    </ul>
                               <aside class="notes">
                                </aside>
                                </section>

				<section>
                                    <h2>Lab 5: Restart Jenkins to enable new plugins</h2>
                                    <ul>
                                            <li>Will take a few minutes to complete</li>
                                            <li>After Jenkins has restarted, verified that the <b>Build Pipeline</b> plugin is listed under the installed tab</li>
                                            <li>Go to <b>http://your_jenkins_server/restart</b> if it doesn't restart automatically</li>
                                    </ul>
                                    <a class="image" href="images/jenkinstestspipeline.png" target="_blank">
                                    <img width="1125" height="427" src="images/jenkinspipeline.png" alt="jenkinstestresults"></a>
                               <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                    <h2>Lab 5: Add a new build pipeline view</h2>
                                    <ul>
                                            <li>Select <b>My Views</b> on the left hand side</li>
					    <li>On the views pages, select <b>+</b> to add a new view</li>
                                            <li>Select <b>Build Pipeline View</b></li>
                                            <li>Select <b>OK</b></li>
                                            <li>Enter <b>Build Pipeline</b> for the name</li>
					    <li>The defaults are okay, select <b>OK</b></li>
                                    </ul>
                                    <a class="image" href="images/jenkinsview.png" target="_blank">
                                    <img width="1133" height="469" src="images/jenkinsview.png" alt="jenkinsnewview"></a>
				</section>


                               <section>
                                    <h2>Lab 5: Look at build pipeline view</h2>
                                    <ul>
                                    </ul>
                                    <a class="image" href="images/jenkinspview.png" target="_blank">
                                    <img width="1113" height="390" src="images/jenkinspview.png" alt="jenkinspipelineview"></a>
                                </section>


                                <section>
                                    <h2>Lab 5: Add two new build jobs</h2>
                                    <ul>
                                    <li>Select <b>Jenkins</b> to go back to the dashboard</li>
                                    <li>Select <b>New Item</b> on left side of screen</li>
                                    <li>In <b>Item name</b> give your job a name like <i>Performance1</i></li>
                                    <li>Select <b>Freestyle project</b> and select <b>OK</b></li>
                                    <li>Add <b>Build step</b> and select <b>Execute Shell</b></li>
                                    <li>echo "$JOB_NAME is running"</li>
                                    <li>Select <b>Save</b></li>
                                    <li>Repeat these same steps for a job called <b>Deploy1</b></li>
                                    </ul>
                                </section>

                                <section>
                                    <h2>Lab 5: Configure chained builds</h2>
                                    <ul>
                                    <li>On the Jenkins dashboard select <b>build1</b> and then <b>configure</b></li>
                                    <li>Select <b>Add post-build action</b></li>
                                    <li>Select <b>Trigger parameterized build on other projects</b></li>
                                    <li>Select <b>Projects to build</b> and select <b>performance1</b></li>
                                    <li>Select <b>Add Parameters</b></li>
                                    <li>Select <b>Current build parameters</b></li>
                                    <li>Select <b>Save</b></li>
                                    </ul>
                                </section>

                                <section>
                                    <h2>Lab 5: Configure chained builds (2)</h2>
                                    <ul>
                                    <li>Repeat these same steps so the performance build triggers the deployment build</li>
                                    </ul>
                                    <a class="image" href="images/jenkinschain.png" target="_blank">
                                    <img width="876" height="471" src="images/jenkinschain.png" alt="jenkinschain"></a>
                                </section>

                                <section>
                                    <h2>Lab 5: Run builds and look at pipeline</h2>
                                    <ul>
                                    <li>Look at the pipeline view - does it show build -> performance -> deploy</li>
                                    <li>Run the performance and deploy tests (to save time) or build1 if you want</li>
                                    <a class="image" href="images/jenkinspipe.png" target="_blank">
                                    <img width="867" height="334" src="images/jenkinspipe.png" alt="jenkinspipe"></a>
                                    </ul>
                                </section>

                               <section>
                                    <h2>Lab 5: Bonus</h2>
                                    <ul>
                                    <li>Implement another pipeline that runs from a diferent branch or tag</li>
                                    <li>Hint: You can copy existing jobs and modify</li>
                                    </ul>
                                </section>
                                </section>


                                <section>
                                <section>
                                    <h2>Scaling CI in the cloud</h2>
                                    <ul>
                                       <li>Why do we need to scale CI?</li>
                                       <li>Different cloud vendors: Amazon, IBM, Microsoft, Rackspace.. </li>
                                       <li>Goal is to increase capacity while minimizing cost </li>
                                    </li>
                                </section>
                               <aside class="notes">
			       <p>If you build on commit, the number of builds that you run will scale up as people wait in timezones and start landing code</p>
                                </aside>

                                <section>
                                    <h2>More Capacity, less $</h2>
                                    <ul>
				        <li>Run instances in multiple regions</li>
					<li>Start instances in cheaper regions first</li>
					<li>Scripts to automatically shut down inactive instances</li>
					<li>Start instances that have been recently running</li>
					<li>Use spot instances vs on demand instances for tests</li>
                                    </ul>
                                </section>
                                </section>

                                <section>
                                <section>
                                    <h2>Lab 6: REST APIs</h2>
                                    <ul>
                                       <li>Representational state transfer</li>
                                       <li>client server</li>
                                       <li>stateless</li>
                                       <li>lightweight</li>
                                       <li>scalable</li>
                                    </ul>
                               <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                    <h2>Lab 6: Jenkins REST APIs</h2>
                                    <ul>
                                       <li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Remote+access+API"/>Jenkins REST APIs</a></li>
                                       <ul>
                                       <li>XML</li>
                                       <li>JSON</li>
                                       <li>Python</li>
                                       </ul>
                                       <li>extend tooling or reporting</li>
                                    </ul>
                               <aside class="notes">
                                </aside>
                                </section>


                               <section>
                                    <h2>Lab 6: Query your Jenkins server</h2>
                                    <ul>
                                    <li>Install jenkinsapi from pypi to ensure it's sane</li>
                                    <li><b>sudo pip install jenkinsapi</b></li>
                                    <li><a href="https://jenkinsapi.readthedocs.org/en/latest/api.html">Jenkins API reference</a></li>
                                    <li>Example python to query the last successful builds
                                    for each of the builds defined on your Jenkins server</li>
                                    </ul>
                                    <pre><code data-trim contenteditable>
import jenkinsapi

from jenkinsapi.jenkins import Jenkins
J = Jenkins('http://localhost:8080')
print "Jenkins Version %s" % J.version
build_dict = J.keys()
print "Jenkins keys %s" % build_dict
for b in build_dict:
print "Build name %s Last good build %s" % (b, J[b].get_last_good_build()
                                    </code></pre>
                               <aside class="notes">
                                </aside>
                                </section>

                                 <section>
                                    <h2>Lab 6: Query your neighbour's Jenkins server</h2>
                                    <p>Replace localhost in the previous example their fqdn</p>
                               <aside class="notes">
                                </aside>
                                </section>

                                <section>
                                    <h2>Lab 6: Query the plugins installed</h2>
                                    <ul>
                                    <li>Example python to query the last successful builds
                                    for each of the builds defined on your Jenkins server. Query your neighbours too!</p>
                                    </li>
                                    <pre><code data-trim contenteditable>
import jenkinsapi

from jenkinsapi.jenkins import Jenkins
J = Jenkins('http://localhost:8080')
print "Jenkins Version %s" % J.version
for plugin in J.get_plugins().values():
    print "Short Name:%s" %(plugin.shortName)
    print "Long Name:%s" %(plugin.longName)
    print "Version:%s" %(plugin.version)
    print "URL:%s" %(plugin.url)
    print "Active:%s" %(plugin.active)
    print "Enabled:%s" %(plugin.enabled)
                                    </code></pre>
                               <aside class="notes">
                                </aside>
                                </section>


                                </section>



                               <section>
                                <section>
                                    <h2>Challenge Exercise #1</h2>
                                    <ul>
                                            <li>Create a new build pipeline with a different open source project</li>
                                            <ul>
                                             <li>Examples...</li>
                                     </ul>
                                     </ul>
					     <p><b>OR</b></p>
                                </section>

                                <section>
                                    <h2>Challenge Exercise #2 </h2>
                                    <ul>

					    <li>Query the REST API of <a href=https://builds.apache.org/">https://builds.apache.org/</a></li>
					    <li>Please provide source code and define functions as appropriate</li>
					    <li>If you prefer Java, you can use the Jenkins API for Java</li>
					    <li>Or Ruby <a href="https://rubygems.org/gems/jenkins_api_client">Ruby Jenkins API</a></li>
                                            <ul>
                                            <li>What plugins are installed?</li>
                                            <li>What builds are building?</li>
                                            <li>What builds are running?</li>
                                            <li>What builds are pending?</li>
                                            <li>What haven't run a sucessful build in the past week? </li>
                                            <li></li>
                                            </ul>
                                    </ul>
                               <aside class="notes">
                                </aside>
                                </section>
                                </section>

                                <section>
                                        <h2>Further Reading</h2>
					<small><ul><li><a href="http://continuousdelivery.com/">Continuous Delivery - Jez Humble and David Farley</a></li>
                                        <li><a href="http://git-scm.com/book">ProGit - Scott Chacon</a></li>
                                        <li><a href="http://www.amazon.com/Phoenix-Project-DevOps-Helping-Business/dp/0988262592/ref=sr_1_1?s=books&ie=UTF8&qid=1410549956&sr=1-1&keywords=phoenix+project">The Phoenix Project - Gene Kim, Kevin Behr and George Spattford</a></li>
                                        <li><a href="http://www.amazon.ca/Release-Design-Deploy-Production-Ready-Software/dp/0978739213/ref=sr_1_1?ie=UTF8&qid=1410549991&sr=8-1&keywords=release+it">Release It - Michael T. Nygard</a></li>
                                        <li><a href="http://codeascraft.com/">Code as Craft (Etsy Tech blog)</a></li>
                                        <li><a href="http://techblog.netflix.com/">Netflix Tech Blog</a></li>
                                        <li><a href="http://planet.mozilla.org/releng/">Planet Release Engineering (Mozilla)</a></li>
                                        <li><a href="https://wiki.mozilla.org/ReleaseEngineering/Contribute">Contributing to Mozilla Release Engineering</a></li>
                                        <li><a href="http://www.amazon.ca/Making-Software-Really-Works-Believe/dp/0596808321/ref=sr_1_1?ie=UTF8&qid=1410550091&sr=8-1&keywords=making+software">Making Software - edited by Greg Wilson </a></li>
			                </ul></small>
                                </section>
                                <aside class="notes">
                                       Release Engineering and Devops books and blogs to Read
                                </aside>
				
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
